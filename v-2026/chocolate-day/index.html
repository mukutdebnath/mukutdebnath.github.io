<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Chocolate Day</title>
    <link rel="stylesheet" href="../styles.css" />
  </head>
  <body class="theme-chocolate">
    <div class="signature-wrap">
      <div class="signature-text header-text">from dumbo...</div>
    </div>

    <div class="carousel-container">
      <div class="date-header">FEBRUARY 09, 2026</div>
      <hr />

      <div class="slide active">
        <span class="icon wobble">ğŸ«</span>
        <h2>Pick Your Treat</h2>
        <p>
          Choose the chocolate you want for our next meet. Think carefully,
          Madam! You only have one coupon! ğŸ˜ˆ
        </p>
      </div>

      <div class="slide">
        <h3>Select your favourite chocolate:</h3>
        <div class="choc-grid">
          <div
            class="choc-card"
            onclick="selectChoc('Amul Milk Chocolate', this)"
          >
            <span
              ><img src="images/amul.webp" alt="Us" style="width: 75%"
            /></span>
          </div>
          <div
            class="choc-card"
            onclick="selectChoc('Dairy Milk Silk Oreo', this)"
          >
            <span
              ><img src="images/silkoreo.jpeg" alt="Us" style="width: 75%"
            /></span>
          </div>
          <div class="choc-card" onclick="selectChoc('Nestle Classic', this)">
            <span
              ><img src="images/nestle.jpeg" alt="Us" style="width: 75%"
            /></span>
          </div>
          <div class="choc-card" onclick="selectChoc('KitKat', this)">
            <span
              ><img src="images/kitkat.webp" alt="Us" style="width: 75%"
            /></span>
          </div>
        </div>
        <p
          id="selection-msg"
          style="
            font-size: 0.85rem;
            color: var(--chocolate-brown);
            font-weight: bold;
          "
        ></p>
      </div>

      <div class="slide">
        <div class="personal-photo-container">
          <img src="images/cd_silk.PORTRAIT.jpg" alt="Us" style="width: 75%" />
        </div>
        <div class="photo-caption">Did you already forget it? ğŸ¤”</div>
      </div>

      <div class="slide">
        <span class="icon pulse">âœ…</span>
        <h2>Order Confirmed!</h2>
        <div class="receipt">
          <p style="margin: 5px 0">ITEM: <span id="final-choc">None</span></p>
          <p style="margin: 5px 0">PRICE: â‚¹0 (Paid with Love)</p>
          <p style="margin: 5px 0">DELIVERY DATE: Next Meetup</p>
        </div>
        <p>Iâ€™ve received your order! Get ready for the sugar rush.</p>
      </div>

      <div class="nav-buttons">
        <button id="prevBtn" onclick="changeSlide(-1)" disabled>Back</button>
        <div class="dots-container">
            <div class="dot active-dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <button id="nextBtn" onclick="changeSlide(1)">Next</button>
    </div>

      <a href="../index.html" class="back-link" style="margin-top: 20px"
        >ğŸ  Valentine's Week</a
      >
    </div>

    <div class="signature-wrap">
      <div class="signature-text footer-text">...to his madam</div>
    </div>

    <script>
      const FORMSPREE_URL = "https://formspree.io/f/xgolowav";

      let currentSlide = 0;
      let selectedChocolate = "";
      const slides = document.querySelectorAll(".slide");
      const dots = document.querySelectorAll(".dot");
      const nextBtn = document.getElementById("nextBtn");
      const prevBtn = document.getElementById("prevBtn");

      function selectChoc(name, element) {
        selectedChocolate = name;
        document
          .querySelectorAll(".choc-card")
          .forEach((card) => card.classList.remove("selected"));
        element.classList.add("selected");
        document.getElementById("final-choc").innerText = name;
      }

      // Automated background email
      function sendOrderSilent(chocolateName) {
        const timestamp = new Date().toLocaleString("en-IN", {
          timeZone: "Asia/Kolkata",
        });

        fetch(FORMSPREE_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            Order: chocolateName,
            Placed_At: timestamp,
            Message: "Chocolate selection for next meet confirmed by Madam.",
          }),
        });
        // No waiting, no console logsâ€”purely background execution
      }

      function changeSlide(direction) {
        // 1. Validation: Must pick chocolate to leave Slide 2
        if (currentSlide === 1 && direction === 1 && selectedChocolate === "") {
          alert("Select a chocolate first! ğŸ«");
          return;
        }

        // 2. Automated Email: Trigger when she clicks "Checkout" on Slide 3
        if (currentSlide === 2 && direction === 1) {
          sendOrderSilent(selectedChocolate);
        }

        slides[currentSlide].classList.remove("active");
        dots[currentSlide].classList.remove("active-dot");

        currentSlide += direction;
        if (currentSlide >= slides.length) currentSlide = 0;
        if (currentSlide < 0) currentSlide = slides.length - 1;

        slides[currentSlide].classList.add("active");
        dots[currentSlide].classList.add("active-dot");

        // Button Logic
        prevBtn.disabled = currentSlide === 0;

        if (currentSlide === 2) {
          nextBtn.innerText = "Checkout ğŸ›’"; // Button on the memory slide
          nextBtn.style.visibility = "visible";
        } else if (currentSlide === 3) {
          nextBtn.innerText = "Start Over âœ¨";
        } else {
          nextBtn.innerText = "Next";
          nextBtn.style.visibility = "visible";
        }
      }
    </script>
  </body>
</html>
