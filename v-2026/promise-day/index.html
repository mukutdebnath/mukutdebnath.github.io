<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Promise Day - Our Thread</title>
  <link rel="stylesheet" href="../styles.css">
</head>

<body class="theme-promise">

  <div id="reply-toast" class="toast-hidden">Reply Sent</div>

  <div class="signature-wrap">
    <div class="signature-text header-text">from dumbo...</div>
  </div>

  <div class="carousel-container">
    <div class="date-header-promise-day">
      <div class="header-left">
        <a href="javascript:void(0)" id="headerPrevBtn" onclick="changeSlide(-1)" class="nav-link disabled"><img
            src="images/back.png" alt="Back" class="header-icon-img"></a>
      </div>
      <div class="header-center">
        <strong>Promises</strong>
      </div>
      <div class="header-right">
        <a href="javascript:void(0)" id="headerNextBtn" onclick="changeSlide(1)" class="nav-link"><img
            src="images/next.png" alt="Next" class="header-icon-img"></a>
      </div>
    </div>


    <div class="slide active">
      <div class="chat-wallpaper profile-start">

        <div class="profile-container">
          <div class="main-avatar">
            <img src="images/us.SELFIE.jpg" alt="Us">
          </div>

          <div class="profile-info">
            <h2 class="profile-header">Happy Promise Day!</h2>
            <p class="profile-subheading">
              We created this promise thread on 11 February, 2026
            </p>
          </div>
        </div>

      </div>
    </div>

    <!-- Thread 1 -->
    <div class="slide">
      <div class="chat-wallpaper">
        <div class="chat-row row-her ani-1">
          <div class="bubble bubble-her">I promise to annoy you and to be nisthur for eternity.</div>
          <div class="avatar"><img src="images/cd.PORTRAIT.jpg"></div>
        </div>
        <div class="seen-status ani-2">Seen 11:11 PM, 11 Feb 2026</div>
        <div class="chat-row row-me ani-3">
          <div class="avatar"><img src="images/md.PORTRAIT.jpg"></div>
          <div class="bubble bubble-me">And I promise to always get happily annoyed in return.</div>
        </div>
      </div>
    </div>

    <!-- Thread 2 -->
    <div class="slide">
      <div class="chat-wallpaper">
        <div class="chat-row row-me ani-1">
          <div class="avatar"><img src="images/md.PORTRAIT.jpg"></div>
          <div class="bubble bubble-me">I promise to surprise you and make you smile with amazing stuffs like this.</div>
        </div>
        <div class="chat-row row-her ani-2">
          <div class="bubble bubble-her">●●●</div>
          <div class="avatar"><img src="images/cd.PORTRAIT.jpg"></div>
        </div>
        <!-- <div class="seen-status ani-3">Seen 11:11 PM</div> -->
      </div>
    </div>

    <!-- Thread 3 -->
    <div class="slide">
      <div class="chat-wallpaper">
        <div class="chat-row row-her ani-1">
          <div class="bubble bubble-her">I promise to be treated as the best girlfriend and give you as many 8 minutes you need.</div>
          <div class="avatar"><img src="images/cd.PORTRAIT.jpg"></div>
        </div>
        <div class="seen-status ani-2">Seen 11:11 PM, 11 Feb 2026</div>
        <div class="chat-row row-me ani-3">
          <div class="avatar"><img src="images/md.PORTRAIT.jpg"></div>
          <div class="bubble bubble-me">I promise to treat you likewise and always accept all your 8 minute invites.</div>
        </div>
      </div>
    </div>

    <!-- Thread 4 -->
    <div class="slide">
      <div class="chat-wallpaper">
        <div class="chat-row row-me ani-1">
          <div class="avatar"><img src="images/md.PORTRAIT.jpg"></div>
          <div class="bubble bubble-me">I promise to always get fully involved in all your stories and ask the dumbest follow-up questions for you to explain again and again.</div>
        </div>
        <div class="chat-row row-her ani-2">
          <div class="bubble bubble-her">●●●</div>
          <div class="avatar"><img src="images/cd.PORTRAIT.jpg"></div>
        </div>
        <!-- <div class="seen-status ani-3">Seen 11:11 PM</div> -->
      </div>
    </div>

    <form id="promiseForm" action="https://formspree.io/f/xgolowav" method="POST" class="chat-footer-nav">
      <div class="message-input-wrapper">
        <a href="../index.html" class="inner-icon-btn">
          <img src="images/home.png" alt="Home">
        </a>

        <input type="text" name="message" id="userMessageInput" placeholder="Message..." autocomplete="off">

        <a href="javascript:void(0)" class="inner-icon-btn send-btn" onclick="handleSendMessage()">
          <img src="images/send.png" alt="Send">
        </a>
      </div>
    </form>
  </div>
  <div class="signature-wrap">
    <div class="signature-text footer-text">...to his madam</div>
  </div>


  <script>
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');

    function changeSlide(direction) {
      slides[currentSlide].classList.remove('active');
      currentSlide += direction;

      // if (currentSlide >= slides.length) {
      //   window.location.href = '../index.html'; // Go home if "Next" is hit on last slide
      //   return;
      // }
      if (currentSlide < 0) currentSlide = 0;

      slides[currentSlide].classList.add('active');

      // Update Header Links
      const hPrev = document.getElementById('headerPrevBtn');
      const hNext = document.getElementById('headerNextBtn');

      // Disable "Next" button on the last slide
      if (currentSlide === 4) {
        hNext.classList.add('disabled');
      } else {
        hNext.classList.remove('disabled');
      }
      // Disable "Back" if on the first slide
      if (currentSlide === 0) {
        hPrev.classList.add('disabled');
      } else {
        hPrev.classList.remove('disabled');
      }

      // Change "Next" text to "Finish" or similar on the last slide if you want
      // hNext.querySelector('span').innerText = (currentSlide === slides.length - 1) ? "Finish" : "Next ›";
    }

    async function handleSendMessage() {
      // Select the wrapper instead of the container
      const inputWrapper = document.querySelector('.message-input-wrapper');
      const inputField = document.getElementById('userMessageInput');
      const toast = document.getElementById('reply-toast');
      const val = inputField.value.trim();

      if (val === "") {
        inputWrapper.classList.add('input-error');

        toast.innerText = "Please type a message first!";
        toast.className = "toast-visible warning";

        setTimeout(() => {
          inputWrapper.classList.remove('input-error');
          toast.className = "toast-hidden";
          setTimeout(() => { toast.innerText = "Reply Sent"; }, 400);
        }, 1000);

        return;
      }

      // --- Formspree Fetch Logic remains exactly as before ---
      const form = document.getElementById('promiseForm');
      const formData = new FormData(form);

      try {
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: { 'Accept': 'application/json' }
        });

        if (response.ok) {
          inputField.value = "";
          toast.className = "toast-visible";
          setTimeout(() => { toast.className = "toast-hidden"; }, 3000);
        }
      } catch (e) { console.error(e); }
    }

    // Allow "Enter" key to trigger send
    document.getElementById('userMessageInput')?.addEventListener('keypress', function (e) {
      if (e.key === 'Enter') {
        e.preventDefault(); // Prevents page reload
        handleSendMessage();
      }
    });
  </script>
</body>

</html>